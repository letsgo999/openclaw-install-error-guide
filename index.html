<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open CLO Master Troubleshooting Guide</title>
    <!-- 외부 라이브러리 로드: React, Babel, Tailwind, Lucide Icons -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800&display=swap');
        body { font-family: 'Pretendard', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="bg-slate-100 antialiased overflow-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // 아이콘 렌더링을 위한 헬퍼 컴포넌트
        const Icon = ({ name, className }) => {
            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            }, [name]);
            return <i data-lucide={name} className={className}></i>;
        };

        const App = () => {
            const [activeStep, setActiveStep] = useState(0);

            const steps = [
                {
                    id: "step1",
                    title: "Step 01. 가상화 및 WSL 기초 공사",
                    icon: "power",
                    theme: "blue",
                    content: {
                        originalGoal: "윈도우 안에 리눅스(Ubuntu)를 설치하기 위한 가상화 엔진(WSL2) 활성화",
                        originalCommand: "관리자 권한 CMD에서 'wsl --install' 실행",
                        summary: "윈도우 커널에 리눅스를 심는 과정에서의 치명적 오류 분석",
                        analysis: [
                            {
                                issue: "BIOS 가상화(VT-x/AMD-V) 미활성화",
                                cause: "컴퓨터 메인보드 수준에서 가상화를 막아두면 WSL 명령어가 아예 동작하지 않습니다.",
                                solution: "부팅 시 F2/Del 키를 눌러 BIOS 진입 후 'Virtualization'을 'Enabled'로 변경해야 합니다."
                            },
                            {
                                issue: "관리자 권한 미부여",
                                cause: "CMD를 일반 권한으로 실행하면 시스템 설정을 건드리는 WSL 설치가 거부됩니다.",
                                solution: "반드시 '관리자 권한으로 실행'된 CMD에서 명령어를 입력해야 합니다."
                            },
                            {
                                issue: "ISO 파일을 이용한 수동 설치 시도",
                                cause: "WSL은 일반 가상머신(VM)과 달라 ISO가 필요 없습니다. 수동 마운트 시도는 경로 꼬임의 주범입니다.",
                                solution: "wsl --install 명령어를 믿고 기다리는 것이 유일한 정석입니다."
                            }
                        ],
                        commands: ["wsl --install", "wsl -l -v"]
                    }
                },
                {
                    id: "step2",
                    title: "Step 02. 리눅스 내부 환경 및 일꾼 배치",
                    icon: "terminal",
                    theme: "emerald",
                    content: {
                        originalGoal: "설치된 Ubuntu 리눅스 내부에 Python, Node.js 등 개발 환경 구축",
                        originalCommand: "Ubuntu 터미널에서 'sudo apt install nodejs python3-pip' 등 실행",
                        summary: "우분투 내부 설정 중 발생하는 명령어 혼선 해결",
                        analysis: [
                            {
                                issue: "윈도우용 프로그램 설치 시도",
                                cause: "리눅스 터미널 안에서 윈도우용 .exe 파일을 깔려고 하면 절대 작동하지 않습니다.",
                                solution: "반드시 apt(패키지 관리자)를 사용하여 리눅스용 Node, Python을 설치해야 합니다."
                            },
                            {
                                issue: "Sudo 비밀번호 입력 시 반응 없음",
                                cause: "리눅스는 보안상 비밀번호를 쳐도 별(*)표시가 안 나옵니다. 이를 고장으로 오해해 강제 종료하면 패키지가 깨집니다.",
                                solution: "아무 반응이 없어도 비밀번호를 끝까지 치고 엔터를 누르는 인내가 필요합니다."
                            },
                            {
                                issue: "VS Code 연동 실패",
                                cause: "윈도우 VS Code에 'WSL 확장팩'이 없으면 리눅스 내부 파일을 열 수 없습니다.",
                                solution: "VS Code 마켓플레이스에서 'WSL'을 검색해 설치한 뒤, 터미널에서 'code .'을 치세요."
                            }
                        ],
                        commands: ["sudo apt update", "sudo apt upgrade", "code ."]
                    }
                },
                {
                    id: "step3",
                    title: "Step 03. 프로그램 설치 및 외부 연동",
                    icon: "message-square",
                    theme: "orange",
                    content: {
                        originalGoal: "오픈 클로 소스코드 복제 및 AI(LLM)와 텔레그램 메신저 연결",
                        originalCommand: "git clone 실행 후 .env 파일에 API Key와 Token 입력",
                        summary: "API 키 및 텔레그램 토큰 설정 중 발생하는 인증 오류",
                        analysis: [
                            {
                                issue: ".env 파일 오타 및 경로 오류",
                                cause: "API_KEY= 뒤에 띄어쓰기가 있거나 따옴표를 잘못 쓰면 인증에 실패합니다.",
                                solution: "키값만 정확히 입력하고 파일명을 반드시 '.env'로 (앞에 점 포함) 저장해야 합니다."
                            },
                            {
                                issue: "텔레그램 봇 토큰 인식 불가",
                                cause: "BotFather가 준 토큰 전체(숫자:문자열)를 복사하지 않고 일부만 가져오면 작동하지 않습니다.",
                                solution: "숫자로 시작해서 알파벳으로 끝나는 긴 문자열 전체를 복사해 넣으세요."
                            },
                            {
                                issue: "LLM 모델명 불일치",
                                cause: "코드 내부 설정과 내가 발급받은 키의 모델(Claude 3.5, Gemini Pro 등)이 다르면 에러가 납니다.",
                                solution: "내가 발급받은 키가 어떤 모델용인지 확인하고 설정 파일과 일치시켜야 합니다."
                            }
                        ],
                        commands: ["git clone <주소>", "npm install", "cp .env.example .env"]
                    }
                },
                {
                    id: "step4",
                    title: "Step 04. 네트워크 및 원격 접속",
                    icon: "globe",
                    theme: "indigo",
                    content: {
                        originalGoal: "노트북 밖(모바일 등)에서도 접속 가능하도록 네트워크 개방",
                        originalCommand: ".env에서 HOST=0.0.0.0 설정 및 터널링 도구 실행",
                        summary: "왜 내 폰에서는 접속이 안 될까? 네트워크 벽 허물기",
                        analysis: [
                            {
                                issue: "localhost(127.0.0.1)의 함정",
                                cause: "기본 설정인 127.0.0.1은 '나 자신'만 보겠다는 뜻입니다. 폰이나 다른 PC는 접근 불가입니다.",
                                solution: "HOST 설정을 0.0.0.0으로 바꿔서 모든 네트워크 장치를 개방해야 합니다."
                            },
                            {
                                issue: "윈도우 방화벽 차단",
                                cause: "리눅스가 문을 열어도 윈도우 방화벽이 3000번 포트를 막고 있으면 접속이 안 됩니다.",
                                solution: "윈도우 보안 설정에서 특정 포트(예: 3000)에 대한 '인바운드 규칙 허용'을 해줘야 합니다."
                            },
                            {
                                issue: "터널링 도구 연결 끊김",
                                cause: "Cloudflare나 Ngrok을 쓸 때 무료 티어의 세션 제한이나 오타로 인해 주소가 바뀌는 경우입니다.",
                                solution: "로그 창을 실시간으로 모니터링하며 생성된 https 주소가 최신인지 확인하세요."
                            }
                        ],
                        commands: ["hostname -I", "cloudflared tunnel --url http://localhost:3000"]
                    }
                },
                {
                    id: "step5",
                    title: "Step 05. 페르소나 주입 및 실무 최적화",
                    icon: "shield-alert",
                    theme: "amber",
                    content: {
                        originalGoal: "에이전트에게 고유한 이름과 업무 규칙(메모리) 부여",
                        originalCommand: "설정 파일(system_prompt.txt)에 지시문 작성 및 저장",
                        summary: "에이전트가 내 말을 듣지 않는 이유 (프롬프트 오류)",
                        analysis: [
                            {
                                issue: "대화 기억 상실 (Context Loss)",
                                cause: "AI는 대화가 길어지면 처음에 정한 규칙을 잊어버립니다.",
                                solution: "지침을 대화로만 하지 말고, 시스템 메모리 파일(system_prompt)에 박제해야 합니다."
                            },
                            {
                                issue: "비일관적인 답변 톤",
                                cause: "지시문이 너무 모호하면(예: 친절하게 해줘) AI가 자기 마음대로 해석합니다.",
                                solution: "구체적인 제약 조건(예: 3줄 요약, 한글 답변, 코드 위주)을 명시해야 합니다."
                            },
                            {
                                issue: "피드백 반영 실패",
                                cause: "틀린 답변을 그냥 넘어가면 AI는 그게 정답인 줄 알고 계속 틀립니다.",
                                solution: "잘못된 즉시 교정하고, 핵심 교정 사항은 다시 설정 파일에 업데이트해야 합니다."
                            }
                        ],
                        commands: ["vi config/system_prompt.txt", "npm start"]
                    }
                }
            ];

            const current = steps[activeStep];

            return (
                <div className="flex flex-col md:flex-row h-screen bg-slate-100 overflow-hidden">
                    {/* 좌측 사이드바 패널 */}
                    <nav className="w-full md:w-80 bg-slate-900 flex flex-col shadow-2xl z-10 shrink-0">
                        <div className="p-8 border-b border-slate-800">
                            <div className="flex items-center gap-3 text-white mb-2">
                                <Icon name="box" className="text-blue-500 w-6 h-6" />
                                <h1 className="font-black text-xl tracking-tight">Open CLO Lab</h1>
                            </div>
                            <p className="text-xs text-slate-500 font-bold uppercase tracking-widest">Troubleshooting Guide</p>
                        </div>
                        
                        <div className="flex-1 overflow-y-auto p-4 space-y-2 custom-scrollbar text-left">
                            {steps.map((step, idx) => (
                                <button
                                    key={step.id}
                                    onClick={() => setActiveStep(idx)}
                                    className={`w-full text-left p-4 rounded-2xl transition-all duration-200 flex items-center gap-4 ${
                                        activeStep === idx 
                                        ? 'bg-blue-600 text-white shadow-lg md:translate-x-2' 
                                        : 'text-slate-400 hover:bg-slate-800 hover:text-slate-200'
                                    }`}
                                >
                                    <div className={`p-2 rounded-lg ${activeStep === idx ? 'bg-blue-500' : 'bg-slate-800'}`}>
                                        <Icon name={step.icon} className="w-5 h-5 text-white" />
                                    </div>
                                    <div className="flex flex-col">
                                        <p className="text-[10px] font-bold opacity-60 uppercase mb-0.5">Step 0{idx + 1}</p>
                                        <p className="font-bold text-sm leading-tight truncate">{step.title.split('. ')[1]}</p>
                                    </div>
                                </button>
                            ))}
                        </div>

                        <div className="hidden md:block p-6 border-t border-slate-800 bg-slate-950/50">
                            <div className="flex items-center gap-2 text-slate-500 text-[10px] font-bold">
                                <Icon name="info" className="w-3 h-3" />
                                <span>실무 교육 및 복기용 마스터 가이드</span>
                            </div>
                        </div>
                    </nav>

                    {/* 우측 상세 설명 화면 */}
                    <main className="flex-1 overflow-y-auto bg-white relative custom-scrollbar">
                        <div className="max-w-4xl mx-auto p-8 md:p-12">
                            <header className="mb-12">
                                <div className={`inline-flex items-center justify-center p-4 rounded-3xl mb-6 bg-${current.theme}-100 text-${current.theme}-600 shadow-inner`}>
                                    <Icon name={current.icon} className="w-8 h-8" />
                                </div>
                                <h2 className="text-3xl md:text-4xl font-black text-slate-900 mb-4 tracking-tight">{current.title}</h2>
                                <p className="text-xl text-slate-500 leading-relaxed font-medium">{current.content.summary}</p>
                            </header>

                            <div className="space-y-12">
                                {/* 🎯 원래 목표 섹션 (신규 추가) */}
                                <section className="p-8 rounded-[2rem] bg-slate-50 border-2 border-dashed border-slate-200">
                                    <h3 className="flex items-center gap-2 text-xl font-extrabold text-slate-800 mb-4">
                                        <Icon name="target" className="w-6 h-6 text-blue-600" />
                                        원래 시도했던 목표와 명령
                                    </h3>
                                    <div className="space-y-4">
                                        <div className="flex gap-3">
                                            <span className="font-bold text-slate-400 shrink-0">목표:</span>
                                            <p className="text-slate-700 font-semibold">{current.content.originalGoal}</p>
                                        </div>
                                        <div className="flex gap-3">
                                            <span className="font-bold text-slate-400 shrink-0">명령:</span>
                                            <code className="bg-white px-2 py-0.5 rounded border border-slate-300 text-blue-600 font-bold">{current.content.originalCommand}</code>
                                        </div>
                                    </div>
                                </section>

                                {/* 분석 섹션 */}
                                <section>
                                    <h3 className="flex items-center gap-2 text-xl font-bold text-slate-800 mb-6 pb-2 border-b-2 border-slate-100">
                                        <Icon name="alert-circle" className="w-5 h-5 text-red-500" />
                                        왜 실패했을까? (오류 분석)
                                    </h3>
                                    <div className="grid gap-6">
                                        {current.content.analysis.map((item, idx) => (
                                            <div key={idx} className="group p-6 rounded-3xl border border-slate-100 bg-slate-50 hover:bg-white hover:shadow-xl hover:border-blue-100 transition-all">
                                                <div className="flex items-start gap-4">
                                                    <div className="w-8 h-8 rounded-full bg-white flex items-center justify-center shrink-0 shadow-sm font-bold text-slate-400 group-hover:text-blue-500 group-hover:border-blue-200 border border-slate-200">
                                                        {idx + 1}
                                                    </div>
                                                    <div className="space-y-3">
                                                        <h4 className="font-black text-lg text-slate-800 text-left">{item.issue}</h4>
                                                        <div className="space-y-2 text-left">
                                                            <p className="text-sm text-slate-500 leading-relaxed">
                                                                <span className="font-bold text-red-400">원인:</span> {item.cause}
                                                            </p>
                                                            <p className="text-sm text-emerald-600 font-bold flex items-center gap-2">
                                                                <Icon name="check-circle-2" className="w-4 h-4" /> 해결: {item.solution}
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </section>

                                {/* 명령어 섹션 */}
                                <section className="bg-slate-900 rounded-[2.5rem] p-8 text-white shadow-2xl">
                                    <h3 className="flex items-center gap-2 text-lg font-bold mb-6 text-blue-400">
                                        <Icon name="code-2" className="w-5 h-5" /> 핵심 복습 명령어
                                    </h3>
                                    <div className="space-y-3 font-mono text-left">
                                        {current.content.commands.map((cmd, idx) => (
                                            <div key={idx} className="bg-slate-800/50 p-4 rounded-xl border border-slate-700 flex items-center gap-4 group hover:bg-slate-800 transition-colors">
                                                <span className="text-slate-600 text-xs">$</span>
                                                <span className="text-blue-300 group-hover:text-white transition-colors text-sm break-all">{cmd}</span>
                                            </div>
                                        ))}
                                    </div>
                                </section>
                            </div>
                            
                            <footer className="mt-20 pt-10 border-t border-slate-100 text-center pb-10">
                                <p className="text-slate-400 text-sm italic">
                                    "실패의 원인을 아는 것이 진정한 학습의 시작입니다."
                                </p>
                            </footer>
                        </div>
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
